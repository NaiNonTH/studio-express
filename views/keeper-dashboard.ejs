<%- contentFor('styleLink') %>
<link rel="stylesheet" href="/stylesheets/keeper.css">

<%- contentFor('body') %>
<div class="dashboard">
  <div class="box admin-header">
    <div>
        <h2>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Studio</h2>
        <p style="color: #666;">‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•: <%= user.name %></p>
    </div>
    <div style="display:flex; gap: 1rem;">
        <a href="/dashboard" class="button" style="background-color: #666;">‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
        <a href="/logout" class="button">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</a>
    </div>
  </div>

  <div class="box span admin-section">
    <h3>üìä ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á 30 ‡∏ß‡∏±‡∏ô‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á</h3>
    <% if (stats.length === 0) { %>
        <p class="note">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á 30 ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏°‡∏≤</p>
    <% } else { %>
        <table class="admin-table">
            <thead>
                <tr>
                    <th>‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏ã‡∏ô</th>
                    <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏à‡∏≠‡∏á</th>
                </tr>
            </thead>
            <tbody>
                <% stats.forEach(function(stat) { %>
                    <tr>
                        <td><%= stat.zone_name %></td>
                        <td><%= stat.total_usage %> ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</td>
                    </tr>
                <% }); %>
            </tbody>
        </table>
    <% } %>
  </div>

  <div class="box span admin-section">
    <h3>üìÖ ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ (<%= new Date().toLocaleDateString('th-TH') %>)</h3>
    <% if (bookings.length === 0) { %>
        <p class="note">‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏¥‡∏ß‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</p>
    <% } else { %>
        <table class="admin-table">
            <thead>
                <tr>
                    <th>‡πÄ‡∏ß‡∏•‡∏≤</th>
                    <th>‡πÇ‡∏ã‡∏ô</th>
                    <th>‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏à‡∏≠‡∏á</th>
                </tr>
            </thead>
            <tbody>
                <% bookings.forEach(function(item) { %>
                    <tr>
                        <td><%= new Date(item.datetime).toLocaleTimeString('th-TH', { hour: '2-digit', minute: '2-digit' }) %></td>
                        <td><%= item.zone_name %></td>
                        <td><%= item.user_name %></td>
                    </tr>
                <% }); %>
            </tbody>
        </table>
    <% } %>
  </div>

  <div class="box span admin-section">
    <h3>üõ†Ô∏è ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏ã‡∏ô</h3>
    <p class="note" style="text-align: left; margin-bottom: 1rem;">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î ‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡∏¥‡∏î‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÇ‡∏ã‡∏ô (‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏•‡∏ö‡∏ñ‡∏≤‡∏ß‡∏£‡πÑ‡∏î‡πâ)</p>
    
    <% zones.forEach(function(zone) { %>
        <div class="admin-card">
            <form action="/dashboard/keeper/edit-zone" method="POST" class="edit-form">
                <input type="hidden" name="zone_id" value="<%= zone.zone_id %>">
                
                <div class="form-group" style="flex: 0.5;">
                    <label>‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏ã‡∏ô</label>
                    <input type="text" name="zone_name" value="<%= zone.zone_name %>" required>
                </div>

                <div class="form-group" style="flex: 2;">
                    <label>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</label>
                    <input type="text" name="zone_details" value="<%= zone.zone_details %>" required>
                </div>

                <div class="form-group" style="flex: 0.5; min-width: auto;">
                    <label>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</label>
                    <label class="toggle-group">
                        <input type="checkbox" name="is_open" <%= zone.is_open ? 'checked' : '' %>>
                        ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
                    </label>
                </div>

                <button type="submit">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
            </form>
        </div>
    <% }); %>
  </div>

  <div class="box span admin-section">
    <h3>‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏ã‡∏ô‡πÉ‡∏´‡∏°‡πà</h3>
    <div class="admin-card" style="background: #fafafa;">
        <form action="/dashboard/keeper/add-zone" method="POST" class="edit-form">
            <div class="form-group" style="flex: 0.5;">
                <label>‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏ã‡∏ô</label>
                <input type="text" name="zone_name" placeholder="‡πÄ‡∏ä‡πà‡∏ô Studio A" required>
            </div>

            <div class="form-group" style="flex: 2;">
                <label>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</label>
                <input type="text" name="zone_details" placeholder="‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå ‡∏´‡∏£‡∏∑‡∏≠‡∏Ç‡∏ô‡∏≤‡∏î‡∏´‡πâ‡∏≠‡∏á" required>
            </div>

            <div class="form-group" style="flex: 0.5; min-width: auto;">
                <label>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</label>
                <label class="toggle-group">
                    <input type="checkbox" name="is_open" checked>
                    ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
                </label>
            </div>

            <button type="submit">‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏ã‡∏ô</button>
        </form>
    </div>
  </div>
</div>